HF3FS_INCLUDE_DIR ?= /usr/include
HF3FS_LIB_DIR ?= /usr/lib

READ_WRITE_PLUGIN_NAME = usrbio_readwrite_test
READ_WRITE_BIN_NAME = ${READ_WRITE_PLUGIN_NAME}
READ_WRITE_SRC = ${READ_WRITE_PLUGIN_NAME}.cpp
READ_WRITE_OBJ = ${READ_WRITE_PLUGIN_NAME}.o

READ_PLUGIN_NAME= usrbio_read_test
READ_BIN_NAME = ${READ_PLUGIN_NAME}
READ_SRC = ${READ_PLUGIN_NAME}.cpp
READ_OBJ = ${READ_PLUGIN_NAME}.o

CXX = g++
CXXFLAGS = -fPIC -fpermissive -O3 -D_GNU_SOURCE -rdynamic -I${HF3FS_INCLUDE_DIR}
LDFLAGS = -L${HF3FS_LIB_DIR} -lhf3fs_api_shared -Wl,-rpath=${HF3FS_LIB_DIR}

.PHONY: all clean

all: ${READ_WRITE_BIN_NAME} ${READ_BIN_NAME}

${READ_WRITE_BIN_NAME}: ${READ_WRITE_SRC}
	${CXX} ${CXXFLAGS} $^ -o $@ ${LDFLAGS}

${READ_BIN_NAME}: ${READ_SRC}
	${CXX} ${CXXFLAGS} $^ -o $@ ${LDFLAGS}

clean:
	rm -rf ${READ_WRITE_OBJ} ${READ_WRITE_BIN_NAME}
	rm -rf ${READ_OBJ} ${READ_BIN_NAME}
